"use strict";(self.webpackChunkbeta_src=self.webpackChunkbeta_src||[]).push([[14],{2286:function(r,e,t){t.r(e),t.d(e,{default:function(){return er}});var n=t(885),i=t(2791),o=t(4194);var a=t(3967),c=t(6920),s=t(2048),l=t(184),u=function(){return(0,l.jsx)("rect",{className:"trigger",height:"100%",width:"100%",fill:"black",style:{opacity:0}})},d=function(r){var e=r.province,t=r.x,n=r.y,i=(0,a.Z)();return(0,l.jsxs)("svg",{id:"".concat(e,"-center"),width:"34",height:"34",viewBox:"0 0 34 34",fill:"none",x:t,y:n,xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("path",{d:"M17 32.9998C25.8366 32.9998 33 25.8364 33 16.9999C33 8.1634 25.8366 1 17 1C8.16344 1 1 8.1634 1 16.9999C1 25.8364 8.16344 32.9998 17 32.9998Z",stroke:i.palette.primary.main}),(0,l.jsx)("path",{d:"M17.0064 25.7269C21.8263 25.7269 25.7336 21.8196 25.7336 16.9997C25.7336 12.1797 21.8263 8.27243 17.0064 8.27243C12.1866 8.27243 8.2793 12.1797 8.2793 16.9997C8.2793 21.8196 12.1866 25.7269 17.0064 25.7269Z",fill:i.palette.primary.main}),(0,l.jsx)(u,{})]})},f=t(1413),h=function(r){var e=r.id,t=r.style,n=r.text,i=r.x,o=r.y,c=(0,a.Z)();return(0,l.jsx)("text",{className:"label",style:(0,f.Z)({fill:c.palette.primary.main,fontWeight:900,fontSize:"150%",userSelect:"none"},t),x:i,y:o,id:e,children:n},e)};h.defaultProps={id:void 0};var p,v=h,y=function(r){var e,t=r.provinceMapData,n=r.ownerCountryID,i=r.playerCountryID,o=r.highlightSelection,u=(0,a.Z)(),f=(0,s.T)(),h=(0,s.C)(c.vq),p=(h.user,h.members),y=t.province,m="none",D=0;if(n){var x,I,Z=null===(x=p.find((function(r){return r.countryID===Number(n)})))||void 0===x?void 0:x.country;if(Z&&"Sea"!==t.type)m=null===(I=u.palette[Z])||void 0===I?void 0:I.main,D=.4}if(o&&i){var g,w,j=null===(g=p.find((function(r){return r.countryID===i})))||void 0===g?void 0:g.country;if(j)m=null===(w=u.palette[j])||void 0===w?void 0:w.main,D=1}return(0,l.jsxs)("svg",{height:t.height,id:"".concat(y,"-province"),viewBox:t.viewBox,width:t.width,x:t.x,y:t.y,children:[(0,l.jsxs)("g",{onClick:function(r){return e=r,void f(c.I9.processMapClick({evt:e,clickProvince:y}));var e},children:[(null===(e=t.texture)||void 0===e?void 0:e.texture)&&(0,l.jsx)("path",{d:t.path,fill:t.texture.texture,id:"".concat(y,"-texture"),stroke:t.texture.stroke,strokeOpacity:t.texture.strokeOpacity,strokeWidth:t.texture.strokeWidth}),(0,l.jsx)("path",{d:t.path,fill:m,fillOpacity:D,id:"".concat(y,"-control-path"),stroke:u.palette.primary.main,strokeOpacity:1,strokeWidth:1})]}),t.centerPos&&(0,l.jsx)("g",{className:"no-pointer-events",children:(0,l.jsx)(d,{province:y,x:t.centerPos.x,y:t.centerPos.y})}),t.labels&&t.labels.map((function(r,e){var n=r.name,i=r.text,o=r.style,a=r.x,c=r.y,s=i,u="".concat(y,"-label-").concat(n);return s||(s=t.abbr),(0,l.jsx)("g",{className:"no-pointer-events",children:(0,l.jsx)(v,{id:u,name:n,style:o,text:s,x:a,y:c},u||e)},u)}))]})},m=function(r){var e=r.provinceMapData,t=e.province;return(0,l.jsx)("svg",{height:e.height,id:"".concat(t,"-province-overlay"),viewBox:e.viewBox,width:e.width,x:e.x,y:e.y,overflow:"visible",children:(0,l.jsx)("path",{d:e.path,fill:"none",fillOpacity:0,id:"".concat(t,"-choice-outline"),stroke:"black",strokeOpacity:1,strokeWidth:5})})},D=t(5824),x=t(5734),I=function(r){var e=r.children,t=r.name,n=r.x,i=r.y;return(0,l.jsx)("g",{className:"unit-slot",id:"".concat(t,"-unit-slot"),style:{overflow:"visible"},x:n,y:i,transform:"translate(".concat(n," ").concat(i,")"),children:e})},Z=t(3861),g=function(r){var e=r.provinceMapData,t=r.units,n=e.province,i={},o={};return t.filter((function(r){return r.mappedTerritory.province===n})).forEach((function(r){var e;switch(r.drawMode){case Z.OA.NONE:e=D.Z.NONE;break;case Z.OA.HOLD:e=D.Z.HOLD;break;case Z.OA.BUILD:case Z.OA.DISLODGING:e=D.Z.NONE;break;case Z.OA.DISLODGED:e=D.Z.DISLODGED;break;case Z.OA.DISBANDED:e=D.Z.DISBANDED;break;default:e=D.Z.NONE}var t=(0,l.jsx)(x.ZP,{id:"".concat(n,"-unit"),unit:r,unitState:e});r.drawMode===Z.OA.DISLODGING?o[r.mappedTerritory.unitSlotName]=t:i[r.mappedTerritory.unitSlotName]=t})),(0,l.jsxs)("g",{height:e.height,id:"".concat(n,"-province-overlay"),width:e.width,x:e.x,y:e.y,transform:"translate(".concat(e.x," ").concat(e.y,")"),overflow:"visible",children:[e.unitSlots.filter((function(r){return r.name in i})).map((function(r){var e=r.name,t=r.x,n=r.y;return(0,l.jsx)(I,{name:e,x:t,y:n,children:i[e]},e)})),e.unitSlots.filter((function(r){return r.name in o})).map((function(r){var e=r.name,t=r.arrowReceiver,n="".concat(e,"-dislodging");return(0,l.jsx)(I,{name:n,x:t.x,y:t.y,children:o[e]},n)}))]})},w=t(5230),j=t(9234),P=t(5963),T=function(r){var e=r.units,t=r.centersByProvince,n=r.phase,i=r.isLivePhase,o=(0,s.C)(c.BU),a=(0,s.C)(c.Jw),u={};o.data.territoryStatuses.forEach((function(r){u[a.terrIDToProvince[r.id]]=r}));var d=(0,s.C)(c.RY),f=(0,s.C)(c.Jr),h=(0,s.C)(c.vq),p=(h.members,h.user),v=[],D=[];i&&p&&("Diplomacy"===n?d.inProgress?"Move"===d.type?d.viaConvoy?(v=[a.terrIDToProvince[a.unitToTerrID[d.unitID]]],D=f.legalViasByUnitID[d.unitID].map((function(r){return P.ZP[r.dest].province}))):(v=[a.terrIDToProvince[a.unitToTerrID[d.unitID]]],D=f.legalMoveDestsByUnitID[d.unitID].map((function(r){return P.ZP[r].province}))):"Support"===d.type?d.fromTerrID?(v=[a.terrIDToProvince[a.unitToTerrID[d.unitID]],a.terrIDToProvince[d.fromTerrID]],D=f.legalSupportsByUnitID[d.unitID][a.terrIDToProvince[d.fromTerrID]].map((function(r){return r.dest}))):(v=[a.terrIDToProvince[a.unitToTerrID[d.unitID]]],D=Object.keys(f.legalSupportsByUnitID[d.unitID])):"Convoy"===d.type&&(d.fromTerrID?(v=[a.terrIDToProvince[a.unitToTerrID[d.unitID]],a.terrIDToProvince[d.fromTerrID]],D=Object.keys(f.legalConvoysByUnitID[d.unitID][a.terrIDToProvince[d.fromTerrID]])):(v=[a.terrIDToProvince[a.unitToTerrID[d.unitID]]],D=Object.keys(f.legalConvoysByUnitID[d.unitID]))):(v=[],D=[]):"Retreats"===n?d.inProgress?"Retreat"===d.type&&(v=[a.terrIDToProvince[a.unitToTerrID[d.unitID]]],(D=f.legalRetreatDestsByUnitID[d.unitID].map((function(r){return P.ZP[r].province}))).push(v[0])):(v=[],D=Object.keys(f.legalRetreatDestsByUnitID).map((function(r){return a.terrIDToProvince[a.unitToTerrID[r]]}))):"Builds"===n&&(p.member.supplyCenterNo<p.member.unitNo?D=e.filter((function(r){return r.country===p.member.country})).map((function(r){return r.mappedTerritory.province})):p.member.supplyCenterNo>p.member.unitNo&&(D=f.possibleBuildDests.map((function(r){return P.ZP[r].province})))));var x=new Set(v),I=new Set(D),Z=Object.values(w.Z).filter((function(r){return!r.playable})).map((function(r){var e;return(0,l.jsx)(y,{provinceMapData:r,ownerCountryID:null===(e=t[r.province])||void 0===e?void 0:e.ownerCountryID,playerCountryID:null===p||void 0===p?void 0:p.member.countryID,highlightSelection:!1},"".concat(r.province,"-province"))})),T=Object.values(w.Z).filter((function(r){return r.playable&&r.province!==j.Z.NAPLES&&r.province!==j.Z.ROME}));T.push(w.Z[j.Z.NAPLES]),T.push(w.Z[j.Z.ROME]);var O=T.map((function(r){var e,n=x.has(r.province);return(0,l.jsx)(y,{provinceMapData:r,ownerCountryID:null===(e=t[r.province])||void 0===e?void 0:e.ownerCountryID,playerCountryID:null===p||void 0===p?void 0:p.member.countryID,highlightSelection:n},"".concat(r.province,"-province"))})),S=T.filter((function(r){return I.has(r.province)})).map((function(r){return(0,l.jsx)(m,{provinceMapData:r},"".concat(r.province,"-province-border-highlight"))})),k=T.map((function(r){return(0,l.jsx)(g,{provinceMapData:r,units:e},"".concat(r.province,"-province-overlay"))}));return(0,l.jsxs)("g",{id:"wD-boardmap-v10.3.4 1",children:[(0,l.jsx)("g",{id:"unplayable",children:Z}),(0,l.jsx)("g",{id:"playableProvinces",children:O}),(0,l.jsx)("g",{id:"playableProvinceBorderHighlights",children:S}),(0,l.jsx)("g",{id:"playableProvinceOverlays",children:k})]})},O=t.p+"static/media/capturable-land.379f9cca7138664bf782.jpeg",S=t.p+"static/media/sea-texture.fd82ad462f655f49e1f0.png",k=t(4375),b=t(7310),E=t(5173),C=function(r){switch(r){case b.Z.SUPPORT:return(0,l.jsx)(l.Fragment,{children:Object.entries(E.Z.palette.arrowColors).map((function(e){var t=(0,n.Z)(e,2),i=t[0],o=t[1];return(0,l.jsxs)("marker",{id:"arrowHead__".concat(b.Z[r],"_").concat(k.Z[i]),markerWidth:12,markerHeight:8,refX:18,refY:3,orient:"auto",children:[(0,l.jsx)("polygon",{points:"0 0, 6 3, 0 6, 0 5, 4 3, 0 1",fill:o.main}),(0,l.jsx)("polygon",{points:"4 0, 10 3, 4 6, 4 5, 8 3, 4 1",fill:o.main})]},"arrowHead__".concat(b.Z[r],"_").concat(k.Z[i]))}))});case b.Z.HOLD:return(0,l.jsx)(l.Fragment,{children:Object.entries(E.Z.palette.arrowColors).map((function(e){var t=(0,n.Z)(e,2),i=t[0],o=t[1];return(0,l.jsx)("marker",{id:"arrowHead__".concat(b.Z[r],"_").concat(k.Z[i]),markerWidth:90,markerHeight:90,refX:10,refY:45,orient:"auto",markerUnits:"userSpaceOnUse",strokeWidth:4,children:(0,l.jsx)("path",{d:" M 24 72 A 30 30 180 0 1 24 18",stroke:o.main})},"arrowHead__".concat(b.Z[r],"_").concat(k.Z[i]))}))});default:return(0,l.jsx)(l.Fragment,{children:Object.entries(E.Z.palette.arrowColors).map((function(e){var t=(0,n.Z)(e,2),i=t[0],o=t[1];return(0,l.jsx)("marker",{id:"arrowHead__".concat(b.Z[r],"_").concat(k.Z[i]),markerWidth:8,markerHeight:8,refX:i===k.Z.IMPLIED_FOREIGN?0:7.1,refY:4,orient:"auto",children:(0,l.jsx)("polygon",{points:"0 0, 8 4, 0 8",fill:o.main})},"arrowHead__".concat(b.Z[r],"_").concat(k.Z[i]))}))})}},A=function(){return(0,l.jsxs)(l.Fragment,{children:[C(b.Z.HOLD),C(b.Z.MOVE),C(b.Z.SUPPORT)]})},B=t(4942),M=t(4554);!function(r){r[r.Army=2]="Army",r[r.Fleet=4]="Fleet",r[r.All=6]="All"}(p||(p={}));var N,L,U=p,_=(N={Army:U.Army,Fleet:U.Fleet},(0,B.Z)(N,U.Army,"Army"),(0,B.Z)(N,U.Fleet,"Fleet"),L={},(0,B.Z)(L,U.Army,"Build Army"),(0,B.Z)(L,U.Fleet,"Build Fleet"),(0,B.Z)(L,"Build Army",U.Army),(0,B.Z)(L,"Build Fleet",U.Fleet),L),F=t(5469),R=t(4861),H=t(9018),G=function(r){var e=r.availableOrder,t=r.clickCallback,n=r.country,i=r.canBuild,o=r.province,a=r.unitSlotName,c=r.toTerrID,s=w.Z[o],u=s.x+s.unitSlotsBySlotName[a].x,d=s.y+s.unitSlotsBySlotName[a].y,f=70,h=[],p={width:50,height:50},v={cursor:"pointer"},y=0+f/2,m=y-25;if(d-=70,i&U.Army&&h.push((0,l.jsxs)("g",{style:v,onClick:function(){t(e,U.Army,c)},children:[(0,l.jsx)("circle",{fill:"white",r:25,cx:y,cy:35}),(0,l.jsx)("svg",{x:m,y:10,style:p,children:(0,l.jsx)(R.ZP,{country:n,iconState:D.Z.BUILD})})]},"Army")),i&U.Fleet){var x=0;h.length&&(x=f-10,f=2*f-10),h.push((0,l.jsxs)("g",{style:v,onClick:function(){t(e,U.Fleet,c)},children:[(0,l.jsx)("circle",{fill:"white",r:25,cx:y+x,cy:35}),(0,l.jsx)("svg",{x:m+x,y:10,style:p,children:(0,l.jsx)(H.ZP,{country:n,iconState:D.Z.BUILD})})]},"Fleet"))}return u-=f/2,(0,l.jsxs)("svg",{x:u,y:d,children:[(0,l.jsx)("rect",{x:0,y:0,fill:"rgba(0,0,0,.7)",width:f,height:70,rx:10,ry:10}),h]})},V=function(){var r=(0,s.T)(),e=(0,s.C)(c.Jw),t=(0,s.C)(c.RY),n=(0,s.C)((function(r){return r.game.overview.user.member}));if(!t||"Build"!==t.type)return(0,l.jsx)(M.Z,{});var i=e.terrIDToTerritory[t.toTerrID],o=P.ZP[i],a=o.province,u=o.unitSlotName,d="Coast"===w.Z[a].type?U.All:U.Army;return(0,l.jsx)(G,{availableOrder:t.orderID,canBuild:d,clickCallback:function(t,n,i){var o=i;"Build Army"===_[n]&&(o=e.terrIDToProvinceID[i]),r(c.I9.updateOrdersMeta((0,B.Z)({},t,{saved:!1,update:{type:_[n],toTerrID:o}}))),r(c.I9.resetOrder())},country:F.Z[n.country],province:a,unitSlotName:u,toTerrID:t.toTerrID},"".concat(a,"-").concat(u))},W=function(r){var e=r.province,t=r.unitSlotName,n=r.position,i=r.text,o=r.clickHandler,a=((0,s.T)(),w.Z[e]);if(!a||!a.unitSlotsBySlotName[t])return(0,l.jsx)(M.Z,{});var c=a.x+a.unitSlotsBySlotName[t].x,u=a.y+a.unitSlotsBySlotName[t].y,d=55+28*i.length*.4,f=0,h=0;if("top"===n)h=-86.5;else if("bottom"===n)h=86.5;else if("left"===n)f=-(d/2+50);else{if("right"!==n)throw Error(n);f=+(d/2+50)}var p=c-d/2+f,v=u-36.5+h;return(0,l.jsx)("svg",{x:p,y:v,filter:"drop-shadow(10px 10px 18px #222222)",onClick:o,children:(0,l.jsxs)("g",{style:{cursor:"pointer"},children:[(0,l.jsx)("rect",{x:0,y:0,fill:"white",width:d,height:73,rx:35,ry:35}),(0,l.jsx)("text",{x:d/2,y:36.5,textAnchor:"middle",alignmentBaseline:"middle",fontFamily:"Roboto",fontSize:28,style:{userSelect:"none"},fill:"black",children:i})]})})},Y=function(r){var e,t,n=r.units,i=(0,s.T)(),o=(0,s.C)(c.RY),a=(0,s.C)(c.Jw),u=(0,s.C)(c.Jr);if(!o.inProgress||o.type||!o.unitID)return(0,l.jsx)(M.Z,{});var d=n.find((function(r){return r.unit.id===o.unitID})),f=P.ZP[a.unitToTerritory[o.unitID]],h=f.province,p=f.unitSlotName,v=function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return function(){i(c.I9.updateOrder({type:r,viaConvoy:e}))}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(W,{province:h,unitSlotName:p,position:"left",text:"Hold",clickHandler:v("Hold")}),(0,l.jsx)(W,{province:h,unitSlotName:p,position:"right",text:"Move",clickHandler:v("Move")}),(0,l.jsx)(W,{province:h,unitSlotName:p,position:"top",text:"Support",clickHandler:v("Support")}),"Fleet"===(null===d||void 0===d||null===(e=d.unit)||void 0===e?void 0:e.type)&&"Sea"===f.provinceMapData.type&&u.hasAnyLegalConvoysByUnitID[o.unitID]&&(0,l.jsx)(W,{province:h,unitSlotName:p,position:"bottom",text:"Convoy",clickHandler:v("Convoy")})||(0,l.jsx)("g",{}),"Army"===(null===d||void 0===d||null===(t=d.unit)||void 0===t?void 0:t.type)&&u.legalViasByUnitID[o.unitID].length>0&&(0,l.jsx)(W,{province:h,unitSlotName:p,position:"bottom",text:"Via Convoy",clickHandler:v("Move","Yes")})]})},X=t(6051);function J(r,e){var t;return null!==(t=e[r])&&void 0!==t&&t.coastParentID?Number(e[r].coastParentID):r}var z=function(r){var e=r.orders,t=r.units,i=(r.maps,r.territories),o=r.standoffs,a=[],c={};e.forEach((function(r){c[J(r.terrID,i)]=r}));var s=new Set;return function(r,e,t){e.filter((function(r){return"Move"===r.type})).forEach((function(e){if(e.toTerrID){var n=P.ZP[t[e.terrID].name].territory,i=P.ZP[t[e.toTerrID].name].territory;r.push((0,X.ZP)(b.Z.MOVE,"Yes"===e.success?k.Z.MOVE:k.Z.MOVE_FAILED,"unit",n,"territory",i,e.drawAsUnsaved)),e.viaConvoy}}))}(a,e,i),function(r,e,t,n){var i={};e.filter((function(r){return"Support hold"===r.type})).forEach((function(r){var e=J(r.terrID,n),t=r.toTerrID;i[e]=t})),e.filter((function(r){return"Support hold"===r.type})).forEach((function(e){if(e.toTerrID){var o=J(e.terrID,n),a=P.ZP[n[e.terrID].name].territory,c=e.toTerrID,s=t[c],l=s?P.ZP[n[s.terrID].name].territory:P.ZP[n[e.toTerrID].name].territory,u="Yes"===e.success?k.Z.SUPPORT_HOLD:k.Z.SUPPORT_HOLD_FAILED,d=i[c]===o?6:0;r.push((0,X.ZP)(b.Z.HOLD,u,"unit",a,"unit",l,e.drawAsUnsaved,d))}}))}(a,e,c,i),function(r,e,t,n,i){e.filter((function(r){return"Support move"===r.type})).forEach((function(e){if(e.fromTerrID&&e.toTerrID){var o=P.ZP[n[e.terrID].name].territory,a=!1,c=e.fromTerrID,s=t[c];!s||"Move"!==s.type||s.terrID!==e.fromTerrID&&n[s.terrID].coastParentID!==e.fromTerrID.toString()||s.toTerrID!==e.toTerrID&&n[s.toTerrID].coastParentID!==e.toTerrID.toString()||(a=!0);var l=s?P.ZP[n[s.terrID].name].territory:P.ZP[n[e.fromTerrID].name].territory,u="Yes"===e.success?k.Z.SUPPORT_MOVE:k.Z.SUPPORT_MOVE_FAILED;if(a){var d=P.ZP[n[s.toTerrID].name].territory;r.push((0,X.ZP)(b.Z.SUPPORT,u,"unit",o,"arrow",(0,X.o8)("unit",l,"territory",d),e.drawAsUnsaved))}else{var f=P.ZP[n[e.toTerrID].name].territory;r.push((0,X.ZP)(b.Z.SUPPORT,u,"unit",o,"arrow",(0,X.o8)("unit",l,"territory",f),e.drawAsUnsaved));var h="".concat(l,"|").concat(f);i.has(h)||(i.add(h),r.push((0,X.ZP)(b.Z.MOVE,k.Z.IMPLIED_FOREIGN,"unit",l,"territory",f,e.drawAsUnsaved)))}}}))}(a,e,c,i,s),function(r,e,t,n,i){e.filter((function(r){return"Convoy"===r.type})).forEach((function(e){if(e.fromTerrID&&e.toTerrID){var o=P.ZP[n[e.terrID].name].territory,a=P.ZP[n[e.fromTerrID].name].territory,c=!1,s=t[e.fromTerrID];!s||"Move"!==s.type||s.terrID!==e.fromTerrID||s.toTerrID!==e.toTerrID&&n[s.toTerrID].coastParentID!==e.toTerrID.toString()||(c=!0);var l="Yes"===e.success?k.Z.CONVOY:k.Z.CONVOY_FAILED,u=P.ZP[n[e.toTerrID].name].territory;if(r.push((0,X.ZP)(b.Z.CONVOY,l,"unit",o,"arrow",(0,X.o8)("unit",a,"territory",u),e.drawAsUnsaved)),!c){var d="".concat(a,"|").concat(u);i.has(d)||(i.add(d),r.push((0,X.ZP)(b.Z.MOVE,k.Z.IMPLIED_FOREIGN,"unit",a,"territory",u,e.drawAsUnsaved)))}}}))}(a,e,c,i,s),function(r,e,t){e.filter((function(r){return"Retreat"===r.type})).forEach((function(e){if(e.toTerrID){var n=P.ZP[t[e.terrID].name].territory,i=P.ZP[t[e.toTerrID].name].territory;r.push((0,X.ZP)(b.Z.MOVE,k.Z.RETREAT,"unit",n,"territory",i,e.drawAsUnsaved))}}))}(a,e,i),function(r,e,t){e.filter((function(r){return r.drawMode===Z.OA.DISLODGING})).forEach((function(e){if(null!==e.movedFromTerrID){var n=P.ZP[t[e.movedFromTerrID].name].territory,i=P.ZP[t[e.unit.terrID].name].territory;r.push((0,X.ZP)(b.Z.MOVE,k.Z.MOVE,"territory",n,"dislodger",i,!1))}}))}(a,t,i),function(r,e,t){e.filter((function(r){return r.drawMode===Z.OA.BUILD})).forEach((function(e){var i=P.ZP[t[e.unit.terrID].name].territory,o=(0,X.Xr)("unit",i),a=(0,n.Z)(o,4),c=a[0],s=a[1],u=a[2],d=a[3];r.push((0,l.jsx)("circle",{cx:c,cy:s,r:1.4*(u+d)/4,fill:"none",stroke:"rgb(0,150,0)",strokeWidth:.05*(u+d),children:e.drawAsUnsaved&&(0,X._G)()},"build-circle-".concat(i)))}))}(a,t,i),function(r,e,t){e.filter((function(r){return r.drawMode===Z.OA.DISBANDED})).forEach((function(e){var i=P.ZP[t[e.unit.terrID].name].territory,o=(0,X.Xr)("unit",i),a=(0,n.Z)(o,4),c=a[0],s=a[1],u=(a[2],a[3],38);r.push((0,l.jsx)("line",{x1:c-u,y1:s-u,x2:c+u,y2:s+u,stroke:"red",strokeWidth:4,children:e.drawAsUnsaved&&(0,X._G)()},"disbandmark-".concat(i,"-1"))),r.push((0,l.jsx)("line",{x1:c+u,y1:s-u,x2:c-u,y2:s+u,stroke:"red",strokeWidth:4,children:e.drawAsUnsaved&&(0,X._G)()},"disbandmark-".concat(i,"-2")))}))}(a,t,i),function(r,e){e.forEach((function(e){var t=e.province,i=w.Z[t].rootTerritory;if(i){var o=(0,X.Xr)("territory",i),a=(0,n.Z)(o,4),c=a[0],s=a[1],u=(a[2],a[3],15);r.push((0,l.jsx)("line",{x1:c-u,y1:s-u,x2:c+u,y2:s+u,stroke:"tomato",strokeWidth:6},"standoffmark-".concat(t,"-1"))),r.push((0,l.jsx)("line",{x1:c+u,y1:s-u,x2:c-u,y2:s+u,stroke:"tomato",strokeWidth:6},"standoffmark-".concat(t,"-2"))),e.attemptedMoves.forEach((function(e){var t=(0,n.Z)(e,2),i=t[0],o=t[1];r.push((0,X.ZP)(b.Z.MOVE,k.Z.MOVE_FAILED,"unit",i,"territory",o,!1))}))}}))}(a,o),(0,l.jsx)("g",{id:"arrows",children:a})},q=i.forwardRef((function(r,e){var t=r.units,n=r.phase,i=r.orders,o=r.maps,a=r.territories,c=r.centersByProvince,s=r.standoffs,u=r.isLivePhase;return(0,l.jsxs)("svg",{id:"map",fill:"none",ref:e,style:{width:"100%",height:"100%"},xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("g",{id:"full-map-svg",children:(0,l.jsxs)("g",{id:"container",children:[(0,l.jsx)(T,{units:t,centersByProvince:c,phase:n,isLivePhase:u}),(0,l.jsx)(z,{orders:i,units:t,maps:o,territories:a,standoffs:s}),u&&(0,l.jsx)(V,{}),u&&(0,l.jsx)(Y,{units:t})]})}),(0,l.jsxs)("defs",{children:[(0,l.jsx)("pattern",{id:"capturable-land",patternUnits:"userSpaceOnUse",width:"1546",height:"1384",children:(0,l.jsx)("image",{href:O,x:"0",y:"0",width:"1546",height:"1384"})}),(0,l.jsx)("pattern",{id:"sea-texture",patternUnits:"userSpaceOnUse",width:"1546",height:"1384",children:(0,l.jsx)("image",{href:S,x:"0",y:"0",width:"1966",height:"1615"})}),A(),(0,l.jsxs)("pattern",{id:"neutral-land-texture",width:"30",height:"10",patternTransform:"rotate(45 0 0)",patternUnits:"userSpaceOnUse",children:[(0,l.jsx)("rect",{x:"0",y:"0",width:"30",height:"10",style:{fill:"#C5BFBE"}}),(0,l.jsx)("line",{x1:"0",y1:"0",x2:"0",y2:"10",style:{stroke:"#B5AFAE",strokeWidth:30}})]}),(0,l.jsxs)("filter",{id:"selectionGlow",height:"120%",width:"120%",x:"-10%",y:"-10%",children:[(0,l.jsx)("feMorphology",{operator:"dilate",radius:"5",in:"SourceAlpha",result:"thickerSource"}),(0,l.jsx)("feGaussianBlur",{stdDeviation:"8",in:"thickerSource",result:"blurredSource"}),(0,l.jsx)("feFlood",{floodColor:"rgb(100,200,255)",result:"glowColor"}),(0,l.jsx)("feComposite",{in:"glowColor",in2:"blurredSource",operator:"in",result:"selectionGlowGlow"})]}),(0,l.jsxs)("filter",{id:"choiceGlow",height:"120%",width:"120%",x:"-10%",y:"-10%",children:[(0,l.jsx)("feMorphology",{operator:"dilate",radius:"1",in:"SourceAlpha",result:"thickerSource"}),(0,l.jsx)("feGaussianBlur",{stdDeviation:"6",in:"thickerSource",result:"blurredSource"}),(0,l.jsx)("feFlood",{floodColor:"rgb(255,255,255)",result:"glowColor"}),(0,l.jsx)("feComposite",{in:"glowColor",in2:"blurredSource",operator:"in",result:"choicesGlowGlow"})]})]})]})})),K=i.memo(q),Q=t(3622),$=t(8539),rr={DESKTOP:[.45,3],MOBILE_LG:[.32,1.6],MOBILE_LG_LANDSCAPE:[.3,1.6],MOBILE:[.32,1.6],MOBILE_LANDSCAPE:[.27,1.6],TABLET:[.6275,3],TABLET_LANDSCAPE:[.6,3]},er=function(r){var e=r.units,t=r.phase,a=r.orders,u=r.maps,d=r.territories,f=r.centersByProvince,h=r.isLivePhase,p=r.standoffs,v=i.useRef(null),y=(0,Q.Z)(),m=(0,n.Z)(y,1)[0],D=(0,s.T)(),x=(0,s.C)(c.mT),I=function(r){return rr[r]}((0,$.Z)(m)),Z=(0,n.Z)(I,2),g=Z[0],w=Z[1];return"Error"===t?(0,l.jsx)("div",{}):(i.useLayoutEffect((function(){if(v.current){var r=o.Ys(v.current),e=r.select("#container"),t=function(r,e,t,n){var i=t,o=r.height*t;o<n.height&&(i=t+(1-o/n.height));var a,c=e.height*i,s=e.y*i,l=e.width*i,u=e.x*i,d=Math.abs(n.width-l),f=Math.abs(d/2),h=Math.abs(n.height-c),p=Math.abs(h/2),v=(r.y+r.height-(e.y+e.height))*i;return n.height>=c?(a=-s+p,p>v&&(a+=p-v)):a=-s-p,{scale:i,x:n.width>=l?-u+f:-u-f,y:a}}(e.node().getBBox(),r.select("#playableProvinces").node().getBBox(),g,m),n=t.scale,i=t.x,a=t.y,c=o.sPX().translateExtent([[0,0],[6010,3005]]).scaleExtent([n,w]).clickDistance(3).on("zoom",(function(r){var t=r.transform;e.attr("transform",t)}));r.on("wheel",(function(r){return r.preventDefault()})).call(c).call(c.transform,o.CRH.translate(i,a).scale(n)).on("dblclick.zoom",null)}}),[v,m]),i.useEffect((function(){setTimeout((function(){D(c.I9.updateOrdersMeta(x))}),500)}),[]),i.useEffect((function(){var r=function(r){27===(r.which||r.keyCode)&&(r.preventDefault(),D(c.I9.resetOrder()))};return window.addEventListener("keydown",r),function(){return window.removeEventListener("keydown",r)}})),(0,l.jsx)("div",{style:{width:m.width,height:m.height},children:(0,l.jsx)(K,{ref:v,units:e,phase:t,orders:a,maps:u,territories:d,centersByProvince:f,standoffs:p,isLivePhase:h})}))}}}]);
//# sourceMappingURL=14.869b9679.chunk.js.map